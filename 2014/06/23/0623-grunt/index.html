<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Grunt 安装笔记 · ASJMTZ's Blog</title><meta name="description" content="Grunt 安装笔记 - ASJMTZ"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://iamtutu.com/atom.xml" title="ASJMTZ's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/asjmtz" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Grunt 安装笔记</h1><div class="post-info">Jun 23, 2014</div><div class="post-content"><p>#grunt</p>
<blockquote>
<p><a href="http://gruntjs.com/getting-started" target="_blank" rel="external">官网英文教程:getting-started</a><br><a href="http://gruntjs.com/getting-started" target="_blank" rel="external">官网中文教程:快速入门</a></p>
</blockquote>
<h2 id="安装-CLI"><a href="#安装-CLI" class="headerlink" title="###安装 CLI"></a>###安装 CLI</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g grunt-cli</div></pre></td></tr></table></figure>
<p>安装 <code>grunt-cli</code> 并不等于安装了Grunt！</p>
<blockquote>
<p>Grunt CLI的任务很简单：调用与 <code>Gruntfile</code> 在同一目录中Grunt。这样带来的好处是，允许在同一机器同一系统上安装多个版本的Grunt。</p>
</blockquote>
<h2 id="CLI-是如何工作的"><a href="#CLI-是如何工作的" class="headerlink" title="###CLI 是如何工作的"></a>###CLI 是如何工作的</h2><p>每次运行 <code>grunt</code> 时，他就利用node提供的 <code>require()</code> 系统查找本地安装的 Grunt。正是由于这一机制，你可以在项目的任意子目录中运行<code>grunt</code> 。</p>
<p>如果找到一份本地安装的 Grunt，CLI就将其加载，并传递 <code>Gruntfile</code> 中的配置信息，然后执行你所指定的任务。</p>
<p><em>为了更好的理解 Grunt CLI的执行原理，请<a href="https://github.com/gruntjs/grunt-cli/blob/master/bin/grunt" target="_blank" rel="external">参考源码</a>。其实代码很短！</em></p>
<h2 id="准备一份新的-Grunt-项目"><a href="#准备一份新的-Grunt-项目" class="headerlink" title="###准备一份新的 Grunt 项目"></a>###准备一份新的 Grunt 项目</h2><p>一般需要在你的项目中添加两份文件：<code>package.json</code> 和 <code>Gruntfile</code>。</p>
<p><strong>package.json</strong>: 此文件被npm用于存储项目的元数据，以便将此项目发布为npm模块。你可以在此文件中列出项目依赖的grunt和Grunt插件，放置于<a href="https://www.npmjs.org/doc/json.html#devDependencies" target="_blank" rel="external">devDependencies</a>配置段内。</p>
<p><strong>Gruntfile</strong>: 此文件被命名为 <code>Gruntfile.js</code> 或 <code>Gruntfile.coffee</code>，用来配置或定义任务（task）并加载Grunt插件的。</p>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="###package.json"></a>###package.json</h2><p> <code>package.json</code> 应当放置于项目的根目录中，与 <code>Gruntfile</code> 在同一目录中，并且应该与项目的源代码一起被提交。在上述目录(package.json所在目录)中运行 <code>npm install</code> 将依据 <code>package.json</code> 文件中所列出的每个依赖来自动安装适当版本的依赖。</p>
<p>下面列出了几种为你的项目创建 <code>package.json</code> 文件的方式：</p>
<ul>
<li><p>大部分 grunt-init 模版都会自动创建特定于项目的package.json文件。</p>
</li>
<li><p>npm init命令会创建一个基本的package.json文件。</p>
</li>
<li><p>复制下面的案例，并根据需要做扩充，参考此<a href="https://www.npmjs.org/doc/json.html" target="_blank" rel="external">说明</a>.</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;name&quot;: &quot;my-project-name&quot;,</div><div class="line">  &quot;version&quot;: &quot;0.1.0&quot;,</div><div class="line">  &quot;devDependencies&quot;: &#123;</div><div class="line">    &quot;grunt&quot;: &quot;~0.4.1&quot;,</div><div class="line">    &quot;grunt-contrib-jshint&quot;: &quot;~0.6.0&quot;,</div><div class="line">    &quot;grunt-contrib-nodeunit&quot;: &quot;~0.2.0&quot;,</div><div class="line">    &quot;grunt-contrib-uglify&quot;: &quot;~0.2.2&quot;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="安装Grunt-和-grunt插件"><a href="#安装Grunt-和-grunt插件" class="headerlink" title="###安装Grunt 和 grunt插件"></a>###安装Grunt 和 grunt插件</h2><p>向已经存在的 <code>package.json</code> 文件中添加Grunt和grunt插件的最简单方式是通过<code>npm install &lt;module&gt; --save-dev</code> 命令。此命令不光安装了 <code>&lt;module&gt;</code> ，还会自动将其添加到devDependencies 配置段中，遵循tilde version range格式。</p>
<p>例如，下面这条命令将安装Grunt最新版本到项目目录中，并将其添加到devDependencies内：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install grunt --save-dev</div></pre></td></tr></table></figure></p>
<p>同样，grunt插件和其它node模块都可以按相同的方式安装。安装完成后一定要记得将被修改的 <code>package.json</code> 文件提交到源码管理器中。</p>
<h2 id="Gruntfile"><a href="#Gruntfile" class="headerlink" title="###Gruntfile"></a>###Gruntfile</h2><p> <code>Gruntfile.js</code> 或 <code>Gruntfile.coffee</code> 文件是有效的 JavaScript 或 CoffeeScript 文件，应当放在你的项目根目录中，和 <code>package.json</code> 文件在同一目录层级，并和项目源码一起加入源码管理器。</p>
<p>Gruntfile由以下几部分构成：</p>
<ul>
<li>“wrapper” 函数</li>
<li>项目与任务配置</li>
<li>加载grunt插件和任务</li>
<li>自定义任务</li>
</ul>
<h2 id="Gruntfile文件案例"><a href="#Gruntfile文件案例" class="headerlink" title="###Gruntfile文件案例"></a>###Gruntfile文件案例</h2><p>在下面列出的这个 <code>Gruntfile</code> 中，<code>package.json</code>文件中的项目元数据（metadata）被导入到 Grunt 配置中， <code>grunt-contrib-uglify</code> 插件中的<code>uglify</code> 任务（task）被配置为压缩（minify）源码文件并依据上述元数据动态生成一个文件头注释。当在命令行中执行 <code>grunt</code> 命令时，<code>uglify</code> 任务将被默认执行。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">module.exports = function(grunt) &#123;</div><div class="line"></div><div class="line">  // Project configuration.</div><div class="line">  grunt.initConfig(&#123;</div><div class="line">    pkg: grunt.file.readJSON(&apos;package.json&apos;),</div><div class="line">    uglify: &#123;</div><div class="line">      options: &#123;</div><div class="line">        banner: &apos;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n&apos;</div><div class="line">      &#125;,</div><div class="line">      build: &#123;</div><div class="line">        src: &apos;src/&lt;%= pkg.name %&gt;.js&apos;,</div><div class="line">        dest: &apos;build/&lt;%= pkg.name %&gt;.min.js&apos;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  // 加载包含 &quot;uglify&quot; 任务的插件。</div><div class="line">  grunt.loadNpmTasks(&apos;grunt-contrib-uglify&apos;);</div><div class="line"></div><div class="line">  // 默认被执行的任务列表。</div><div class="line">  grunt.registerTask(&apos;default&apos;, [&apos;uglify&apos;]);</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>前面已经向你展示了整个 Gruntfile，接下来将详细解释其中的每一部分。</p>
<h2 id="”wrapper”-函数"><a href="#”wrapper”-函数" class="headerlink" title="###”wrapper” 函数"></a>###”wrapper” 函数</h2><p>每一份 <code>Gruntfile</code> （和grunt插件）都遵循同样的格式，你所书写的Grunt代码必须放在此函数内：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">module.exports = function(grunt) &#123;</div><div class="line">  // Do grunt-related things in here</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h2 id="项目和任务配置"><a href="#项目和任务配置" class="headerlink" title="###项目和任务配置"></a>###项目和任务配置</h2><p>大部分的Grunt任务都依赖某些配置数据，这些数据被定义在一个object内，并传递给<a href="http://www.gruntjs.net/api/grunt/#grunt.initconfig" target="_blank" rel="external">grunt.initConfig</a> 方法。</p>
<p>在下面的案例中，<code>grunt.file.readJSON(&#39;package.json&#39;)</code>  将存储在 <code>package.json</code> 文件中的JSON元数据引入到grunt config中。 由于 <code>&lt;% %&gt;</code> 模板字符串可以引用任意的配置属性，因此可以通过这种方式来指定诸如<strong>文件路径</strong>和<strong>文件列表类型</strong>的配置数据，从而减少一些重复的工作。</p>
<p>你可以在这个配置对象中(传递给initConfig()方法的对象)存储任意的数据，只要它不与你任务配置所需的属性冲突，否则会被忽略。此外，由于这本身就是JavaScript，你不仅限于使用JSON；你可以在这里使用任意的有效的JS代码。如果有必要，你甚至可以以编程的方式生成配置。</p>
<p>与大多数task一样，<a href="http://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="external">grunt-contrib-uglify</a> 插件中的uglify 任务要求它的配置被指定在一个同名属性中。在这里有一个例子, 我们指定了一个banner选项(用于在文件顶部生成一个注释)，紧接着是一个单一的名为build的uglify目标，用于将一个js文件压缩为一个目标文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// Project configuration.</div><div class="line">grunt.initConfig(&#123;</div><div class="line">  pkg: grunt.file.readJSON(&apos;package.json&apos;),</div><div class="line">  uglify: &#123;</div><div class="line">    options: &#123;</div><div class="line">      banner: &apos;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n&apos;</div><div class="line">    &#125;,</div><div class="line">    build: &#123;</div><div class="line">      src: &apos;src/&lt;%= pkg.name %&gt;.js&apos;,</div><div class="line">      dest: &apos;build/&lt;%= pkg.name %&gt;.min.js&apos;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="加载-Grunt-插件和任务"><a href="#加载-Grunt-插件和任务" class="headerlink" title="###加载 Grunt 插件和任务"></a>###加载 Grunt 插件和任务</h2><p>像 <a href="https://github.com/gruntjs/grunt-contrib-concat" target="_blank" rel="external">concatenation</a>、<a href="http://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="external">grunt-contrib-uglify</a> 和<a href="https://github.com/gruntjs/grunt-contrib-jshint" target="_blank" rel="external">linting</a>这些常用的任务（task）都已经以<a href="https://github.com/gruntjs" target="_blank" rel="external">grunt插件</a>的形式被开发出来了。只要在 <code>package.json</code> 文件中被列为dependency（依赖）的包，并通过 <code>npm install</code> 安装之后，都可以在 <code>Gruntfile</code> 中以简单命令的形式使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 加载能够提供&quot;uglify&quot;任务的插件。</div><div class="line">grunt.loadNpmTasks(&apos;grunt-contrib-uglify&apos;);</div></pre></td></tr></table></figure></p>
<p>注意： <code>grunt --help</code> 命令将列出所有可用的任务。</p>
<h2 id="自定义任务"><a href="#自定义任务" class="headerlink" title="###自定义任务"></a>###自定义任务</h2><p>通过定义 <code>default</code> 任务，可以让Grunt默认执行一个或多个任务。在下面的这个案例中，执行 <code>grunt</code> 命令时如果不指定一个任务的话，将会执行<code>uglify</code>任务。这和执行 <code>grunt uglify</code> 或者 <code>grunt default</code> 的效果一样。<code>default</code> 任务列表数组中可以指定任意数目的任务（可以带参数）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// Default task(s).</div><div class="line">grunt.registerTask(&apos;default&apos;, [&apos;uglify&apos;]);</div></pre></td></tr></table></figure></p>
<p>如果Grunt插件中的任务（task）不能满足你的项目需求，你还可以在Gruntfile中自定义任务（task）。例如，在下面的 Gruntfile 中自定义了一个default 任务，并且他甚至不依赖任务配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">module.exports = function(grunt) &#123;</div><div class="line"></div><div class="line">  // A very basic default task.</div><div class="line">  grunt.registerTask(&apos;default&apos;, &apos;Log some stuff.&apos;, function() &#123;</div><div class="line">    grunt.log.write(&apos;Logging some stuff...&apos;).ok();</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>特定于项目的任务不必在 Gruntfile 中定义。他们可以定义在外部.js 文件中，并通过<a href="http://www.gruntjs.net/api/grunt/#grunt.loadtasks" target="_blank" rel="external">grunt.loadTasks</a> 方法加载。</p>
<hr>
<p>以上是grunt中文网上的get-started教程的抄写版，下面是我自己的流程表</p>
<ol>
<li>全局安装 <code>grunt-cli</code> ，即 <code>npm install -g grunt-cli</code></li>
<li>在项目文档的根目录，写 <code>pacakage.json</code> ,里面包括项目名称，版本号，还有<code>devDependencies</code> 即一些grunt和grunt插件，还可以定义<strong>文档的目录</strong>等之后可能会用到的属性</li>
<li>根据package.json中写的的 <code>Dependencies</code> ,用 <code>npm install &lt;grunt-plungin&gt; --save-dev</code> 安装 <code>grunt</code>及其他需要的插件。插件安装完后，还会根据安装的版本，依照这个tilde version range格式，更改 <code>package.json</code>里面的值</li>
<li>接下来写gruntfile.js文件，放在 <code>package.json</code>一起的根目录。里面是grunt插件的配置与使用，还可以自定义任务，具体看上面</li>
</ol>
</div></article></div></section><footer><div class="paginator"><a href="/2014/06/23/0623-gruntfile 配置/" class="prev">上一篇</a><a href="/2014/06/18/0618-phonegap/" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2017 <a href="http://iamtutu.com">ASJMTZ</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>