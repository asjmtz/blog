<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Angular Template 模板 · ASJMTZ's Blog</title><meta name="description" content="Angular Template 模板 - ASJMTZ"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://iamtutu.com/atom.xml" title="ASJMTZ's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/asjmtz" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Angular Template 模板</h1><div class="post-info">Sep 26, 2014</div><div class="post-content"><p>为了说明Angular怎样加强标准HTML，这一节会将一个纯html转为模板，Angular用他来展示一些数据集合。我们加的数据是两个手机的基本信息。</p>
<h2 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h2><p>调整工作区到step1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -f step-1</div></pre></td></tr></table></figure></p>
<p>然后别忘了 <code>npm start</code> ，在浏览器上查看新的页面展示。</p>
<p>这是个纯html的静态模板，下面看看Angular的动态模板是怎么弄的。马上就到了step 2。</p>
<h2 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -f step-2</div></pre></td></tr></table></figure>
<p>Angular比较提倡使用 <strong>MVC 设计模式</strong> 来结耦代码。由于这个理念，这个步骤使用了一些 JS 代码来增加app中的 model，view 和 controller 组件。</p>
<h3 id="View-and-Template"><a href="#View-and-Template" class="headerlink" title="View and Template"></a>View and Template</h3><p>在 Angular 中，视图是模型通过 HTML 模板的映射。这意味着，无论何时数据模型的变化，都能刷新绑定点而更新视图。</p>
<p><code>app/index.html:</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;html ng-app=&quot;phonecatApp&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">  ...</div><div class="line">  &lt;script src=&quot;bower_components/angular/angular.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;script src=&quot;js/controllers.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body ng-controller=&quot;PhoneListCtrl&quot;&gt;</div><div class="line"></div><div class="line">  &lt;ul&gt;</div><div class="line">    &lt;li ng-repeat=&quot;phone in phones&quot;&gt;</div><div class="line">      &#123;&#123;phone.name&#125;&#125;</div><div class="line">      &lt;p&gt;&#123;&#123;phone.snippet&#125;&#125;&lt;/p&gt;</div><div class="line">    &lt;/li&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line"></div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<h3 id="ng-repeat"><a href="#ng-repeat" class="headerlink" title="ng-repeat"></a>ng-repeat</h3><p>我们将硬代码写的phone  list 替换为 <code>ngRepeat directive</code> 和两个 Angular expression。</p>
<ul>
<li>这个 <code>ng-repeat=&quot;phone in phones&quot;</code> 属性是一个Angular repeater指令。repeater让 Angular 为每个list里的phone建立 <code>&lt;li&gt;</code> 模板。总之就是模板中的 <code>for in</code> 循环。</li>
</ul>
<h3 id="ng-controller"><a href="#ng-controller" class="headerlink" title="ng-controller"></a>ng-controller</h3><p>这个指令绑定个 <code>PhoneListCtrl</code> 的 controller 到 body 上。数据 <code>{{phone.name}}</code> 和 <code>{{phone.snippet}}</code> 是他设置的，(⊙_⊙)。</p>
<h3 id="ng-app"><a href="#ng-app" class="headerlink" title="ng-app"></a>ng-app</h3><p>前面出现的这个指令，现在给他赋值了之后，则表示 <code>phonecarApp</code> 是一个module模块名。这个模块包含着<code>PhoneListCtrl</code> 这个控制器。</p>
<p>他们的关系图：</p>
<p><img src="http://iamtutu.qiniudn.com/tutorial_02.png" alt="关系图"></p>
<h3 id="Module-and-Controller"><a href="#Module-and-Controller" class="headerlink" title="Module and Controller"></a>Module and Controller</h3><p><code>app/js/controllers.js:</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var phonecatApp = angular.module(&apos;phonecatApp&apos;, []);</div><div class="line"></div><div class="line">phonecatApp.controller(&apos;PhoneListCtrl&apos;, function ($scope) &#123;</div><div class="line">  $scope.phones = [</div><div class="line">    &#123;&apos;name&apos;: &apos;Nexus S&apos;,</div><div class="line">     &apos;snippet&apos;: &apos;Fast just got faster with Nexus S.&apos;&#125;,</div><div class="line">    &#123;&apos;name&apos;: &apos;Motorola XOOM™ with Wi-Fi&apos;,</div><div class="line">     &apos;snippet&apos;: &apos;The Next, Next Generation tablet.&apos;&#125;,</div><div class="line">    &#123;&apos;name&apos;: &apos;MOTOROLA XOOM™&apos;,</div><div class="line">     &apos;snippet&apos;: &apos;The Next, Next Generation tablet.&apos;&#125;</div><div class="line">  ];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ol>
<li>在html标签上定义的模块名字 <code>phonecatApp</code> ，在这里注册为 Angular 的 module。</li>
<li>然后在这个module下注册了一个控制器——<code>PhoneListCtrl</code></li>
</ol>
<p>控制器让我们能够在 model 和 view 之间建立数据绑定。<code>PhoneListCtrl</code> 控制器绑定 phone data 到 <code>$scope</code> 。这个 scope 是 root scope 的 prototypical descendant（原型子孙）？？root scope在app 开始时被定义。这个控制器的scope可以使用到任何在控制器标签中的绑定。</p>
<h3 id="scope"><a href="#scope" class="headerlink" title="scope"></a>scope</h3><p>在Angular中scope的概念十分的重要，他是将template、model和controller公共工作的粘合剂。<br>详细的Angular scope 介绍请翻墙看：<a href="https://docs.angularjs.org/api/ng/type/$rootScope.Scope" target="_blank" rel="external"> angular scope documentation.</a> ^_^</p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><h4 id="全局控制器"><a href="#全局控制器" class="headerlink" title="全局控制器"></a>全局控制器</h4><p>用Angular 的方法将控制器从视图中分离，我们可以方便的编写测试代码。如果控制器在全局作用域可用，我们可用一个虚拟的scope来实例化控制器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">describe(&apos;PhoneListCtrl&apos;, function()&#123;</div><div class="line"></div><div class="line">it(&apos;should create &quot;phones&quot; model with 3 phones&apos;, function() &#123;</div><div class="line">  var scope = &#123;&#125;,</div><div class="line">      ctrl = new PhoneListCtrl(scope);</div><div class="line"></div><div class="line">  expect(scope.phones.length).toBe(3);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>在Angular中写单元测试挺方便啊O(∩_∩)O哈哈~<br>因为在软件开发中，测试是一个关键的步骤，所以Angular简化了测试，以鼓励coder们多写测试啊。</p>
<h4 id="非全局控制器"><a href="#非全局控制器" class="headerlink" title="非全局控制器"></a>非全局控制器</h4><p>Angular提供了一个service服务——<code>$controller</code> 。他可以通过名字获取你的控制器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">describe(&apos;PhoneListCtrl&apos;, function()&#123;</div><div class="line"></div><div class="line">beforeEach(module(&apos;phonecatApp&apos;));</div><div class="line"></div><div class="line">it(&apos;should create &quot;phones&quot; model with 3 phones&apos;, inject(function($controller) &#123;</div><div class="line">  var scope = &#123;&#125;,</div><div class="line">      ctrl = $controller(&apos;PhoneListCtrl&apos;, &#123;$scope:scope&#125;);</div><div class="line"></div><div class="line">  expect(scope.phones.length).toBe(3);</div><div class="line">&#125;));</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>解释：</p>
<ul>
<li>告诉Angular 在每个测试之前加载 <code>phonecatApp</code> 模块</li>
<li>让Angular 注册 <code>$controller</code> 服务到我们的测试函数</li>
<li>用 <code>$controller</code> 来建立一个 <code>PhoneListCtrl</code> 的实例</li>
<li>在实例中，我们来证实phones数组拥有三个记录的属性</li>
</ul>
<h3 id="Writing-and-Running-Tests-写跑测试"><a href="#Writing-and-Running-Tests-写跑测试" class="headerlink" title="Writing and Running Tests 写跑测试"></a>Writing and Running Tests 写跑测试</h3><p>angular-seed项目预先配置了使用 <strong>Karma</strong> 来跑单元测试，确保开跑前已经使用 <code>npm install</code> 安装了Karma相关的组件。</p>
<p>使用 <code>npm test</code> 开跑：</p>
<ul>
<li>Karma 会打开一个浏览器的页面来跑你的测试，可以无视</li>
<li><p>你会看到命令台输出（大概）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">info: Karma server started at http://localhost:9876/</div><div class="line"> info (launcher): Starting  browser &quot;Chrome&quot;</div><div class="line"> info (Chrome 22.0): Connected on socket id tPUm9DXcLHtZTKbAEO-n</div><div class="line"> Chrome 22.0: Executed 1 of 1 SUCCESS (0.093 secs / 0.004 secs)</div></pre></td></tr></table></figure>
<p>(^o^)/ success！！</p>
</li>
<li><p>当你修改你的test.js的源文件时，Karma会默认帮你重跑一遍，so sweet O(∩_∩)O</p>
</li>
</ul>
</div></article></div></section><footer><div class="paginator"><a href="/2014/09/30/0930-protractor/" class="prev">上一篇</a><a href="/2014/09/26/0926-angular lesson2/" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2017 <a href="http://iamtutu.com">ASJMTZ</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>